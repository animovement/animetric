% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_nnd.R
\name{compute_nnd}
\alias{compute_nnd}
\title{Compute nearest neighbour distances for a single time point}
\usage{
compute_nnd(
  x,
  y,
  z = NULL,
  individual,
  keypoint = NULL,
  n = 1L,
  keypoint_neighbour = NULL
)
}
\arguments{
\item{x}{Numeric vector of x coordinates.}

\item{y}{Numeric vector of y coordinates.}

\item{z}{Numeric vector of z coordinates, or NULL for 2D data.}

\item{individual}{Factor or vector identifying which individual each point
belongs to.}

\item{keypoint}{Factor or vector identifying keypoint labels, or NULL if no
keypoints.}

\item{n}{Which individual to find (1 = nearest, 2 = second nearest, etc.).}

\item{keypoint_neighbour}{Character vector of keypoint(s) to consider as
valid neighbours, or NULL to consider all.}
}
\value{
A tibble with columns:
\itemize{
\item \code{nnd_individual}: individual ID of the n-th nearest individual
\item \code{nnd_keypoint}: keypoint of the closest point on that individual (only
if \code{keypoint} is not NULL)
\item \code{nnd_distance}: distance to the closest point on the n-th nearest
individual
}
}
\description{
Low-level function that computes distances to the nth nearest individual.
For each focal point, finds the closest point belonging to the nth nearest
individual (ranked by minimum distance). Called by \code{\link[=calculate_nnd]{calculate_nnd()}} for
each time point.
}
\seealso{
\code{\link[=calculate_nnd]{calculate_nnd()}} for the user-facing aniframe function
}
